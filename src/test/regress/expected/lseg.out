--
-- LSEG
-- Line segments
--
--DROP TABLE LSEG_TBL;
CREATE TABLE LSEG_TBL (s lseg);
INSERT INTO LSEG_TBL VALUES ('[(1,2),(3,4)]');
INSERT INTO LSEG_TBL VALUES ('(0,0),(6,6)');
INSERT INTO LSEG_TBL VALUES ('10,-10 ,-3,-4');
INSERT INTO LSEG_TBL VALUES ('[-1e6,2e2,3e5, -4e1]');
INSERT INTO LSEG_TBL VALUES (lseg(point(11, 22), point(33,44)));
INSERT INTO LSEG_TBL VALUES ('[(-10,2),(-10,3)]');	-- vertical
INSERT INTO LSEG_TBL VALUES ('[(0,-20),(30,-20)]');	-- horizontal
INSERT INTO LSEG_TBL VALUES ('[(NaN,1),(NaN,90)]');	-- NaN
-- bad values for parser testing
INSERT INTO LSEG_TBL VALUES ('(3asdf,2 ,3,4r2)');
ERROR:  invalid input syntax for type lseg: "(3asdf,2 ,3,4r2)"
LINE 1: INSERT INTO LSEG_TBL VALUES ('(3asdf,2 ,3,4r2)');
                                     ^
INSERT INTO LSEG_TBL VALUES ('[1,2,3, 4');
ERROR:  invalid input syntax for type lseg: "[1,2,3, 4"
LINE 1: INSERT INTO LSEG_TBL VALUES ('[1,2,3, 4');
                                     ^
INSERT INTO LSEG_TBL VALUES ('[(,2),(3,4)]');
ERROR:  invalid input syntax for type lseg: "[(,2),(3,4)]"
LINE 1: INSERT INTO LSEG_TBL VALUES ('[(,2),(3,4)]');
                                     ^
INSERT INTO LSEG_TBL VALUES ('[(1,2),(3,4)');
ERROR:  invalid input syntax for type lseg: "[(1,2),(3,4)"
LINE 1: INSERT INTO LSEG_TBL VALUES ('[(1,2),(3,4)');
                                     ^
select * from LSEG_TBL;
               s               
-------------------------------
 [(1,2),(3,4)]
 [(0,0),(6,6)]
 [(10,-10),(-3,-4)]
 [(-1000000,200),(300000,-40)]
 [(11,22),(33,44)]
 [(-10,2),(-10,3)]
 [(0,-20),(30,-20)]
 [(NaN,1),(NaN,90)]
(8 rows)

SELECT lseg_send(s) FROM LSEG_TBL;
                             lseg_send                              
--------------------------------------------------------------------
 \x3ff0000000000000400000000000000040080000000000004010000000000000
 \x0000000000000000000000000000000040180000000000004018000000000000
 \x4024000000000000c024000000000000c008000000000000c010000000000000
 \xc12e848000000000406900000000000041124f8000000000c044000000000000
 \x4026000000000000403600000000000040408000000000004046000000000000
 \xc0240000000000004000000000000000c0240000000000004008000000000000
 \x0000000000000000c034000000000000403e000000000000c034000000000000
 \x7ff80000000000003ff00000000000007ff80000000000004056800000000000
(8 rows)

